<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nmap_utils</title>
    <link rel="icon" type="image/svg+xml" href="https://n.maps.yandex.ru/favicon-dot.svg">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap"
            rel="stylesheet">
</head>

<body>
<div class="container">
    <header class="header">
        <a href="https://n.maps.yandex.ru/#!" target="_blank" rel="noopener noreferrer">
            <svg width="300" height="190" viewBox="0 0 300 190" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M150 79C159.181 79 166.625 71.5567 166.625 62.375C166.625 53.1933 159.181 45.75 150 45.75C140.818 45.75 133.375 53.1933 133.375 62.375C133.375 71.5567 140.818 79 150 79ZM150 75.5C157.248 75.5 163.125 69.6237 163.125 62.375C163.125 55.1263 157.248 49.25 150 49.25C142.751 49.25 136.875 55.1263 136.875 62.375C136.875 69.6237 142.751 75.5 150 75.5Z"
                      fill="#8B8B8B"/>
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M143.627 117.554C143.897 120.53 146.207 123.625 150 123.625C153.792 123.625 156.102 120.53 156.373 117.554C156.67 114.286 159.172 110.55 163.322 106.413C166.152 103.591 169.314 100.983 172.364 98.466L172.364 98.4657C173.726 97.3425 175.065 96.2376 176.343 95.1402C179.127 92.7491 181.791 90.0926 184.058 86.9568C189.055 80.0455 192 71.5486 192 62.375C192 39.1785 173.196 20.375 150 20.375C131.381 20.375 115.602 32.4862 110.092 49.2509C108.001 55.6119 107.473 62.4536 108.528 69.0525C109.585 75.6637 112.184 81.7594 115.941 86.9568C118.208 90.0926 120.873 92.7491 123.657 95.1402C124.934 96.2375 126.273 97.3423 127.635 98.4655L127.635 98.466C130.685 100.982 133.847 103.591 136.677 106.413C140.827 110.55 143.329 114.286 143.627 117.554ZM150 23.875C132.938 23.875 118.469 34.9727 113.417 50.3437C111.502 56.1692 111.017 62.4466 111.984 68.5C112.952 74.5562 115.333 80.1412 118.778 84.9062C120.833 87.7492 123.284 90.206 125.937 92.4852C127.109 93.4917 128.386 94.5452 129.712 95.6397C137.251 101.862 146.401 109.413 147.112 117.237C147.256 118.825 148.406 120.125 150 120.125C151.594 120.125 152.743 118.825 152.887 117.237C153.598 109.413 162.748 101.862 170.287 95.6398C171.614 94.5452 172.89 93.4917 174.062 92.4852C176.716 90.206 179.166 87.7492 181.222 84.9062C185.801 78.5717 188.5 70.7882 188.5 62.375C188.5 41.1114 171.263 23.875 150 23.875Z"
                      fill="#8B8B8B"/>
                <path d="M29.392 151.88H22.2V140H19.6V166.54H22.2V154.156H29.392V166.54H31.992V140H29.392V151.88Z"
                      fill="#8B8B8B"/>
                <path
                        d="M95.3839 155.624H89.9919V147.596H87.4999V166.54H89.9919V157.792H95.3839V166.54H97.8759V147.596H95.3839V155.624Z"
                        fill="#8B8B8B"/>
                <path
                        d="M133.147 166.54H130.655V147.596H133.147V155.278L138.625 147.596H141.261L134.995 156.428L141.662 166.54H138.834L133.147 158.059V166.54Z"
                        fill="#8B8B8B"/>
                <path d="M170.648 166.54H173.14V149.8H177.316V147.596H166.436V149.8H170.648V166.54Z"
                      fill="#8B8B8B"/>
                <path
                        d="M211.516 155.624H216.908V147.596H219.4V166.54H216.908V157.792H211.516V166.54H209.024V147.596H211.516V155.624Z"
                        fill="#8B8B8B"/>
                <path
                        d="M248.07 166.54H250.562V158.059L256.248 166.54H259.077L252.41 156.428L258.676 147.596H256.04L250.562 155.278V147.596H248.07V166.54Z"
                        fill="#8B8B8B"/>
                <path
                        d="M266.282 164.37L266.289 164.367C266.715 164.188 267.062 163.98 267.338 163.747L267.348 163.738L267.36 163.729C267.682 163.493 267.963 163.202 268.203 162.853L268.633 162.227L269.521 164.537L269.402 164.711C269.111 165.134 268.743 165.501 268.303 165.813C267.926 166.108 267.445 166.351 266.874 166.55C266.291 166.787 265.629 166.9 264.896 166.9C262.925 166.9 261.384 166.005 260.308 164.262L260.304 164.256C259.269 162.514 258.772 160.116 258.772 157.104C258.772 154.069 259.268 151.659 260.304 149.916C261.358 148.143 262.914 147.236 264.932 147.236C265.912 147.236 266.769 147.411 267.487 147.782C268.176 148.115 268.749 148.542 269.197 149.069L269.332 149.227L268.6 152.039L268.102 151.366C267.72 150.849 267.259 150.399 266.717 150.014C266.215 149.659 265.625 149.476 264.932 149.476C264.306 149.476 263.78 149.631 263.338 149.93C262.894 150.229 262.51 150.689 262.198 151.335C261.586 152.65 261.264 154.561 261.264 157.104C261.264 159.574 261.586 161.451 262.199 162.767C262.499 163.413 262.877 163.872 263.32 164.17C263.761 164.468 264.293 164.624 264.932 164.624C265.464 164.624 265.911 164.535 266.282 164.37Z"
                        fill="#8B8B8B"/>
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M42.7621 166.54L42.6765 166.255C42.6029 166.01 42.5178 165.705 42.4212 165.343L42.4173 165.329L42.4145 165.314C42.392 165.193 42.3707 165.062 42.3507 164.919C42.0271 165.361 41.6617 165.742 41.2532 166.06C40.5272 166.624 39.6582 166.9 38.6677 166.9C37.3293 166.9 36.22 166.395 35.3737 165.39L35.3704 165.386C34.5253 164.356 34.1277 162.959 34.1277 161.244C34.1277 159.233 34.6625 157.648 35.7979 156.564C36.9284 155.461 38.5431 154.94 40.5757 154.94H42.1557V153.072C42.1557 151.711 41.9059 150.816 41.4885 150.299C41.0794 149.793 40.4527 149.512 39.5317 149.512C38.8291 149.512 38.174 149.676 37.5606 150.005L37.5506 150.01C36.9394 150.316 36.4387 150.75 36.0445 151.32L35.5651 152.012L34.808 149.391L34.9277 149.232C35.335 148.689 35.9302 148.234 36.6866 147.855C37.4985 147.437 38.4515 147.236 39.5317 147.236C41.119 147.236 42.3905 147.691 43.2786 148.657C44.195 149.604 44.6117 151.045 44.6117 152.892V162.792C44.6117 163.4 44.6467 164.021 44.7171 164.655C44.7878 165.268 44.8796 165.712 44.9844 166.005L45.1753 166.54H42.7621ZM40.8487 163.827C41.3988 163.189 41.8358 162.416 42.1557 161.501V156.964H40.6117C39.1547 156.964 38.1618 157.312 37.5465 157.927C36.9342 158.539 36.5837 159.565 36.5837 161.1C36.5837 162.35 36.8274 163.249 37.261 163.85C37.714 164.445 38.2919 164.732 39.0277 164.732C39.7386 164.732 40.3369 164.445 40.8435 163.833L40.8487 163.827Z"
                      fill="#8B8B8B"/>
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M50.7319 166.38L50.7408 166.385L50.7499 166.39C51.3858 166.708 52.0838 166.864 52.8368 166.864C54.6764 166.864 56.1504 165.957 57.2428 164.23L57.2442 164.228C58.3349 162.478 58.8528 159.892 58.8528 156.528C58.8528 155.187 58.7431 153.96 58.5211 152.85C58.2999 151.72 57.9775 150.745 57.5473 149.935C57.1164 149.099 56.5746 148.435 55.9145 147.959C55.2459 147.478 54.4921 147.236 53.6648 147.236C52.5546 147.236 51.6099 147.624 50.8595 148.4C50.4872 148.772 50.1536 149.173 49.8586 149.602L49.7619 147.596H47.5048V172.156H49.9968V165.877C50.2199 166.062 50.4652 166.229 50.7319 166.38ZM51.4328 150.506C51.7437 150.196 52.0588 149.959 52.377 149.789L52.3849 149.785C52.7139 149.6 53.0429 149.512 53.3768 149.512C54.217 149.512 54.933 150.018 55.4966 151.258C56.0624 152.502 56.3608 154.296 56.3608 156.672C56.3608 159.533 56.0128 161.593 55.3596 162.9C54.7055 164.185 53.8954 164.732 52.9448 164.732C52.187 164.732 51.5994 164.565 51.1541 164.262C50.7163 163.963 50.3267 163.499 49.9968 162.843V152.862C50.1745 152.428 50.3831 152.016 50.6222 151.625L50.6269 151.616C50.8767 151.185 51.1458 150.816 51.4328 150.506Z"
                      fill="#8B8B8B"/>
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M73.0341 164.372C73.4144 164.11 73.7887 163.519 74.0964 162.464L74.0985 162.457C74.4482 161.337 74.7204 159.925 74.9107 158.213C75.0297 157.094 75.113 155.939 75.1607 154.748L75.161 154.74C75.3038 152.36 75.406 149.98 75.4568 147.596H84.0964V164.372H85.7523V170.104H83.6439L83.4279 166.54H74.3168L74.1008 170.104H71.9923V164.372H73.0341ZM77.6518 152.445C77.6037 153.359 77.5436 154.369 77.4715 155.474C77.3991 156.56 77.3025 157.635 77.1818 158.697C77.0128 160.218 76.7945 161.497 76.5244 162.529C76.3552 163.238 76.1249 163.856 75.8267 164.372H81.5684V149.764H77.7501L77.6518 152.445Z"
                      fill="#8B8B8B"/>
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M108.567 166.353C108.586 166.415 108.605 166.478 108.624 166.54H111.037C110.815 165.919 110.655 165.316 110.579 164.655C110.508 164.021 110.473 163.4 110.473 162.792V152.892C110.473 151.045 110.057 149.604 109.14 148.657C108.252 147.691 106.981 147.236 105.393 147.236C104.313 147.236 103.36 147.437 102.548 147.855C101.801 148.229 101.17 148.724 100.67 149.391L101.427 152.012L101.906 151.32C102.3 150.75 102.801 150.316 103.412 150.01L103.422 150.005C104.036 149.676 104.691 149.512 105.393 149.512C106.314 149.512 106.941 149.793 107.35 150.299C107.768 150.816 108.017 151.711 108.017 153.072V154.94H106.437C104.405 154.94 102.79 155.461 101.66 156.564C100.524 157.648 99.9894 159.233 99.9894 161.244C99.9894 162.959 100.387 164.356 101.232 165.386L101.235 165.39C102.082 166.395 103.191 166.9 104.529 166.9C105.52 166.9 106.389 166.624 107.115 166.06C107.523 165.742 107.889 165.361 108.212 164.919C108.281 165.408 108.424 165.881 108.567 166.353ZM108.017 161.501C107.698 162.416 107.261 163.189 106.71 163.827L106.705 163.833C106.199 164.445 105.6 164.732 104.889 164.732C104.154 164.732 103.576 164.445 103.123 163.85C102.689 163.249 102.445 162.35 102.445 161.1C102.445 159.565 102.796 158.539 103.408 157.927C104.024 157.312 105.016 156.964 106.473 156.964H108.017V161.501Z"
                      fill="#8B8B8B"/>
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M115.737 159.11C114.945 158.736 114.295 158.132 113.787 157.315C113.186 156.348 112.898 155.154 112.898 153.756C112.898 152.738 113.035 151.837 113.319 151.062L113.323 151.051C113.627 150.292 114.024 149.647 114.52 149.125L114.528 149.117C115.05 148.594 115.666 148.214 116.37 147.979C117.064 147.722 117.805 147.596 118.59 147.596H122.014V166.54H119.558V159.736H118.013L114.701 166.54H112.041L115.737 159.11ZM116.312 150.66C115.73 151.222 115.39 152.195 115.39 153.684C115.39 155.153 115.695 156.137 116.222 156.726C116.782 157.326 117.544 157.64 118.554 157.64H119.558V149.728H118.662C117.731 149.728 116.955 150.038 116.312 150.66Z"
                      fill="#8B8B8B"/>
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M196.209 152.708C196.839 153.99 197.782 154.939 199.031 155.543L194.229 166.54H196.939L201.439 156.136H203.332V166.54H205.932V140H201.932C201.082 140 200.248 140.181 199.432 140.538L199.428 140.539C198.635 140.898 197.921 141.408 197.288 142.067L197.283 142.073C196.667 142.74 196.174 143.566 195.799 144.54C195.419 145.529 195.232 146.635 195.232 147.852C195.232 149.675 195.553 151.294 196.206 152.7L196.209 152.708ZM200.442 142.636L200.449 142.633C200.953 142.392 201.446 142.276 201.932 142.276H203.332V153.86H201.68C201.195 153.86 200.731 153.745 200.282 153.51C199.839 153.277 199.426 152.924 199.049 152.436C198.698 151.953 198.405 151.338 198.175 150.58C197.95 149.835 197.832 148.94 197.832 147.888C197.832 146.914 197.96 146.085 198.205 145.394C198.457 144.686 198.771 144.105 199.144 143.644C199.542 143.18 199.976 142.848 200.442 142.636Z"
                      fill="#8B8B8B"/>
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M238.643 162.903C238.943 163.501 239.308 163.927 239.729 164.204C240.148 164.48 240.645 164.624 241.237 164.624C241.795 164.624 242.268 164.535 242.666 164.367C243.092 164.188 243.439 163.98 243.714 163.747L243.725 163.738L243.736 163.729C244.059 163.493 244.34 163.202 244.579 162.853L245.005 162.234L245.9 164.502L245.776 164.679C245.462 165.123 245.082 165.503 244.638 165.817C244.243 166.106 243.767 166.348 243.217 166.549C242.632 166.787 241.956 166.9 241.201 166.9C240.182 166.9 239.276 166.68 238.497 166.224C237.718 165.769 237.088 165.09 236.602 164.209C235.644 162.469 235.185 160.076 235.185 157.068C235.185 155.558 235.319 154.208 235.591 153.02C235.861 151.817 236.232 150.783 236.712 149.925L236.716 149.917C237.22 149.061 237.824 148.397 238.535 147.948C239.247 147.475 240.03 147.236 240.877 147.236C241.742 147.236 242.527 147.46 243.22 147.913C243.915 148.368 244.474 149.04 244.907 149.905C245.34 150.771 245.637 151.837 245.809 153.09C245.982 154.328 245.993 155.763 245.847 157.392L245.815 157.756H237.652C237.728 160.024 238.068 161.729 238.643 162.903ZM242.792 150.92C242.23 149.863 241.584 149.44 240.877 149.44C240.118 149.44 239.399 149.903 238.739 151.04C238.154 152.065 237.794 153.581 237.693 155.624H243.485C243.581 153.419 243.332 151.875 242.797 150.929L242.792 150.92Z"
                      fill="#8B8B8B"/>
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M221.542 164.372C221.922 164.11 222.296 163.519 222.604 162.464L222.606 162.457C222.956 161.337 223.228 159.925 223.418 158.213C223.537 157.094 223.621 155.939 223.668 154.748L223.669 154.74C223.811 152.36 223.914 149.98 223.964 147.596H232.604V164.372H234.26V170.104H232.152L231.936 166.54H222.824L222.608 170.104H220.5V164.372H221.542ZM226.159 152.445C226.111 153.359 226.051 154.369 225.979 155.474C225.907 156.56 225.81 157.635 225.689 158.697C225.52 160.218 225.302 161.497 225.032 162.529C224.863 163.238 224.633 163.856 224.334 164.372H230.076V149.764H226.258L226.159 152.445Z"
                      fill="#8B8B8B"/>
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M158.227 166.38L158.236 166.385L158.245 166.39C158.881 166.708 159.579 166.864 160.332 166.864C162.172 166.864 163.646 165.957 164.738 164.23L164.739 164.228C165.83 162.478 166.348 159.892 166.348 156.528C166.348 155.187 166.238 153.96 166.016 152.85C165.795 151.72 165.473 150.745 165.043 149.935C164.612 149.099 164.07 148.435 163.41 147.959C162.741 147.478 161.987 147.236 161.16 147.236C160.05 147.236 159.105 147.624 158.355 148.4C157.982 148.772 157.649 149.173 157.354 149.602L157.257 147.596H155V172.156H157.492V165.877C157.715 166.062 157.96 166.23 158.227 166.38ZM158.928 150.506C159.239 150.196 159.554 149.959 159.872 149.789L159.88 149.785C160.209 149.6 160.538 149.512 160.872 149.512C161.712 149.512 162.428 150.018 162.992 151.258C163.558 152.502 163.856 154.296 163.856 156.672C163.856 159.533 163.508 161.593 162.855 162.9C162.201 164.185 161.391 164.732 160.44 164.732C159.682 164.732 159.095 164.565 158.649 164.262C158.212 163.963 157.822 163.499 157.492 162.843V152.862C157.67 152.428 157.878 152.016 158.117 151.625L158.122 151.616C158.372 151.185 158.641 150.816 158.928 150.506Z"
                      fill="#8B8B8B"/>
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M150.134 166.54C150.116 166.478 150.097 166.415 150.078 166.353C149.935 165.881 149.792 165.408 149.723 164.919C149.399 165.361 149.034 165.742 148.626 166.06C147.9 166.624 147.031 166.9 146.04 166.9C144.702 166.9 143.592 166.395 142.746 165.39L142.743 165.386C141.898 164.356 141.5 162.959 141.5 161.244C141.5 159.233 142.035 157.648 143.17 156.564C144.301 155.461 145.915 154.94 147.948 154.94H149.528V153.072C149.528 151.711 149.278 150.816 148.861 150.299C148.452 149.793 147.825 149.512 146.904 149.512C146.201 149.512 145.546 149.676 144.933 150.005L144.923 150.01C144.312 150.316 143.811 150.75 143.417 151.32L142.937 152.012L142.18 149.392C142.681 148.724 143.312 148.229 144.059 147.855C144.871 147.437 145.824 147.236 146.904 147.236C148.491 147.236 149.763 147.691 150.651 148.657C151.567 149.604 151.984 151.045 151.984 152.892V162.792C151.984 163.4 152.019 164.021 152.089 164.655C152.166 165.316 152.326 165.919 152.548 166.54H150.134ZM148.221 163.827C148.771 163.189 149.208 162.416 149.528 161.501V156.964H147.984C146.527 156.964 145.534 157.312 144.919 157.927C144.306 158.539 143.956 159.565 143.956 161.1C143.956 162.35 144.2 163.249 144.633 163.85C145.086 164.445 145.664 164.732 146.4 164.732C147.111 164.732 147.709 164.445 148.216 163.833L148.221 163.827Z"
                      fill="#8B8B8B"/>
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M186.567 166.353C186.586 166.415 186.605 166.478 186.624 166.54H189.037C188.815 165.919 188.655 165.316 188.579 164.655C188.508 164.021 188.473 163.4 188.473 162.792V152.892C188.473 151.045 188.057 149.604 187.14 148.657C186.252 147.691 184.981 147.236 183.393 147.236C182.313 147.236 181.36 147.437 180.548 147.855C179.801 148.229 179.17 148.724 178.67 149.392L179.427 152.012L179.906 151.32C180.3 150.75 180.801 150.316 181.412 150.01L181.422 150.005C182.036 149.676 182.691 149.512 183.393 149.512C184.314 149.512 184.941 149.793 185.35 150.299C185.768 150.816 186.017 151.711 186.017 153.072V154.94H184.437C182.405 154.94 180.79 155.461 179.66 156.564C178.524 157.648 177.989 159.233 177.989 161.244C177.989 162.959 178.387 164.356 179.232 165.386L179.235 165.39C180.082 166.395 181.191 166.9 182.529 166.9C183.52 166.9 184.389 166.624 185.115 166.06C185.523 165.742 185.889 165.361 186.212 164.919C186.281 165.408 186.424 165.881 186.567 166.353ZM186.017 161.501C185.698 162.416 185.261 163.189 184.71 163.827L184.705 163.833C184.199 164.445 183.6 164.732 182.889 164.732C182.154 164.732 181.576 164.445 181.123 163.85C180.689 163.249 180.445 162.35 180.445 161.1C180.445 159.565 180.796 158.539 181.408 157.927C182.024 157.312 183.016 156.964 184.473 156.964H186.017V161.501Z"
                      fill="#8B8B8B"/>
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M278.899 166.424L278.878 166.352C278.735 165.881 278.592 165.408 278.523 164.919C278.199 165.361 277.834 165.742 277.426 166.06C276.7 166.624 275.831 166.9 274.84 166.9C273.502 166.9 272.392 166.395 271.546 165.39L271.543 165.386C270.698 164.356 270.3 162.959 270.3 161.244C270.3 159.233 270.835 157.648 271.97 156.564C273.101 155.461 274.715 154.94 276.748 154.94H278.328V153.072C278.328 151.711 278.078 150.816 277.661 150.299C277.252 149.793 276.625 149.512 275.704 149.512C275.001 149.512 274.346 149.676 273.733 150.005L273.723 150.01C273.112 150.316 272.611 150.75 272.217 151.32L271.737 152.012L270.98 149.392C271.481 148.724 272.112 148.229 272.859 147.855C273.671 147.437 274.624 147.236 275.704 147.236C277.291 147.236 278.563 147.691 279.451 148.657C280.367 149.604 280.784 151.045 280.784 152.892V162.792C280.784 163.4 280.819 164.021 280.889 164.655C280.966 165.316 281.126 165.919 281.348 166.54H278.934C278.923 166.501 278.911 166.463 278.899 166.424ZM277.021 163.827C277.571 163.189 278.008 162.416 278.328 161.501V156.964H276.784C275.327 156.964 274.334 157.312 273.719 157.927C273.106 158.539 272.756 159.565 272.756 161.1C272.756 162.35 273 163.249 273.433 163.85C273.886 164.445 274.464 164.732 275.2 164.732C275.911 164.732 276.509 164.445 277.016 163.833L277.021 163.827Z"
                      fill="#8B8B8B"/>
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M63.7104 166.266C62.9797 165.822 62.3507 165.189 61.8196 164.379L61.8147 164.372C61.3068 163.559 60.9091 162.558 60.6139 161.377L60.6135 161.375C60.316 160.161 60.17 158.759 60.17 157.176C60.17 155.64 60.3162 154.263 60.6132 153.05C60.9079 151.822 61.3048 150.785 61.8119 149.949L61.8137 149.946C62.3428 149.089 62.9704 148.418 63.7017 147.947C64.4376 147.474 65.2446 147.236 66.114 147.236C66.9739 147.236 67.7745 147.445 68.5084 147.865C69.2482 148.287 69.8687 148.927 70.3763 149.763C70.9098 150.577 71.3195 151.592 71.6143 152.796C71.9121 153.988 72.058 155.377 72.058 156.96C72.058 158.496 71.9117 159.873 71.6145 161.087C71.3195 162.292 70.9103 163.328 70.3806 164.187C69.875 165.045 69.2588 165.718 68.5263 166.188C67.7904 166.662 66.9834 166.9 66.114 166.9C65.2541 166.9 64.4534 166.691 63.7195 166.271L63.7104 166.266ZM68.4682 162.951L68.4655 162.956C67.7581 164.211 66.9672 164.732 66.114 164.732C65.6713 164.732 65.2435 164.603 64.824 164.331C64.4362 164.065 64.0682 163.641 63.7304 163.035C63.4178 162.43 63.1528 161.642 62.9422 160.661C62.7566 159.661 62.662 158.465 62.662 157.068C62.662 154.33 63.0337 152.389 63.7235 151.185C64.453 149.956 65.2556 149.44 66.114 149.44C66.5575 149.44 66.9714 149.569 67.3641 149.838L67.374 149.845L67.3842 149.851C67.7841 150.091 68.1467 150.494 68.4587 151.096L68.4643 151.106C68.7966 151.704 69.0615 152.499 69.2486 153.505L69.2509 153.516C69.4592 154.488 69.566 155.67 69.566 157.068C69.566 159.781 69.1825 161.723 68.4682 162.951Z"
                      fill="#8B8B8B"/>
            </svg>
        </a>

    </header>

    <main>
        <section class="upload-section">
            <div class="tabs upload-tabs">
                <button type="button" class="tab-btn active" data-tab="own-sources"
                        data-group="upload-tabs">Собственные источники
                </button>
                <button type="button" class="tab-btn" data-tab="official-sources"
                        data-group="upload-tabs">Официальные источники данных и GIS
                </button>
            </div>

            <form action="/" method="post" enctype="multipart/form-data" class="upload-form" id="uploadForm">
                <input type="file" name="files" id="files_shp" accept=".zip" multiple style="display: none;">
                <input type="file" name="files" id="files_gpx" accept=".gpx" multiple style="display: none;">
                <input type="file" name="files" id="files_kml" accept=".kml,.kmz" multiple style="display: none;">
                <input type="file" name="files" id="files_geojson" accept=".geojson" multiple
                       style="display: none;">
                <input type="file" name="files" id="files_topojson" accept=".topojson" multiple
                       style="display: none;">
                <input type="file" name="files" id="files_wkt" accept=".wkt" multiple style="display: none;">

                <div class="tab-content active" id="own-sources-tab" data-group="upload-tabs">
                    <div class="button-grid">
                        <button type="button" class="submit-btn" id="uploadBtn">Загрузить SHP</button>
                        <button type="button" class="submit-btn" id="uploadBtnGpx">Загрузить GPX</button>
                        <button type="button" class="submit-btn" id="uploadBtnKml">Загрузить KML/KMZ</button>
                        <button type="button" class="submit-btn" id="uploadBtnGeojson">Загрузить GeoJSON</button>
                        <button type="button" class="submit-btn" id="uploadBtnTopojson">Загрузить TopoJSON</button>
                        <button type="button" class="submit-btn" id="uploadBtnWkt">Загрузить WKT</button>
                    </div>
                </div>
                <div class="tab-content" id="official-sources-tab" data-group="upload-tabs">
                    <div class="nspd-container" style="margin-bottom: 20px; display: flex; gap: 10px;">
                        <label for="nspd_registry_number"></label><input type="text" id="nspd_registry_number"
                                                                         placeholder="Реестровый номер (23:00-4.84)"
                                                                         style="width: 40%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;">
                        <button type="button" class="submit-btn" id="uploadBtnNspdlocality"
                                style="width: 60%; white-space: nowrap;">Границы населенного пункта из ПКК
                        </button>
                    </div>
                    <div class="nspd-container" style="margin-bottom: 20px; display: flex; gap: 10px;">
                        <label for="nspd_border_registry_number"></label><input type="text"
                                                                                id="nspd_border_registry_number"
                                                                                placeholder="Реестровый номер (23:01-6.1)"
                                                                                style="width: 40%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;">
                        <button type="button" class="submit-btn" id="uploadBtnNspdBorder"
                                style="width: 60%; white-space: nowrap;">Границы муниципального образования из ПКК
                        </button>
                    </div>
                    <div class="button-grid">
                        <button type="button" class="submit-btn" id="uploadBtnOotp">Особо охраняемые природные
                            территории
                        </button>
                    </div>
                    <div class="accordion" style="margin-top: 20px;">
                        <!-- Аккордеон 1: Населенные пункты -->
                        <div class="accordion-item">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <h3 class="accordion-title">Инструкция: Границы населенных пунктов</h3>
                                <svg class="accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </div>
                            <div class="accordion-content">
                                <div class="accordion-body">
                                    <h3>Инструкция по загрузке границ населенных пунктов</h3>
                                    <div>
                                        <p>Для загрузки границ населенных пунктов используется ресурс <a
                                                href="https://nspd.gov.ru">"Портал пространственных данных
                                            Национальной системы пространственных данных".</a></p>

                                        <p>Для выбора населённого пункта необходимо:</p>

                                        <ol>
                                            <li>Открыть раздел <a
                                                    href="https://nspd.gov.ru/map?thematic=PKK&zoom=10&baseLayerId=235&theme_id=1&is_copy_url=true&active_layers=36281&coordinate_x=4697360&coordinate_y=5614808">"Публичная
                                                кадастровая карта"</a>.
                                            </li>
                                            <li>Перейти в подраздел "Административные границы".</li>
                                            <li>Выбрать категорию "Населённые пункты".</li>
                                            <li>Активировать чекбокс "Населённые пункты (полигоны)".</li>
                                        </ol>

                                        <p>После этих действий на карте отобразятся границы для загрузки которых
                                            необходимо: </p>
                                        <ol>
                                            <li>Кликнуть на нужный населённый пункт.</li>
                                            <li>Скопировать его "Реестровый номер".</li>
                                            <li>Вставить скопированный номер в форму на странице nmaps_utils.</li>
                                            <li>Нажать кнопку "Границы населенного пункта из ПКК".</li>
                                        </ol>
                                    </div>
                                    <div
                                            style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; margin-top: 20px;">
                                        <iframe
                                                style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
                                                src="https://www.youtube.com/embed/wXTr_J-f9q8"
                                                title="YouTube video player" frameborder="0"
                                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                                allowfullscreen>
                                        </iframe>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Аккордеон 2: Муниципальные образования -->
                        <div class="accordion-item">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <h3 class="accordion-title">Инструкция: Муниципальные образования</h3>
                                <svg class="accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </div>
                            <div class="accordion-content">
                                <div class="accordion-body">
                                    <h3>Инструкция по загрузке границ муниципальных образований</h3>
                                    <div>
                                        <p>Для загрузки границ муниципальных образований используется ресурс <a
                                                href="https://nspd.gov.ru">"Портал пространственных данных
                                            Национальной системы пространственных данных".</a></p>
                                        <p>Для выбора муниципального образования необходимо:</p>

                                        <ol>
                                            <li>Открыть раздел <a
                                                    href="https://nspd.gov.ru/map?thematic=PKK&zoom=10&baseLayerId=235&theme_id=1&is_copy_url=true&active_layers=36281&coordinate_x=4697360&coordinate_y=5614808">"Публичная
                                                кадастровая карта"</a>.
                                            </li>
                                            <li>Перейти в подраздел "Административные границы".</li>
                                            <li>Выбрать категорию "Муниципальные образования".</li>
                                            <li>Активировать чекбокс "Муниципальные образования (полигоны)".</li>
                                        </ol>

                                        <p>После этих действий на карте отобразятся границы для загрузки которых
                                            необходимо:</p>
                                        <ol>
                                            <li>Кликнуть на нужное образование.</li>
                                            <li>Скопировать его "Реестровый номер".</li>
                                            <li>Вставить скопированный номер в форму на странице nmaps_utils.</li>
                                            <li>Нажать кнопку "Границы муниципального образования из ПКК".</li>
                                        </ol>
                                    </div>
                                    <div
                                            style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; margin-top: 20px;">
                                        <iframe
                                                style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
                                                src="https://www.youtube.com/embed/U0wXNoQkzys"
                                                title="YouTube video player" frameborder="0"
                                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                                allowfullscreen>
                                        </iframe>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Аккордеон 3: Особо охранные природные территории -->
                        <div class="accordion-item">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <h3 class="accordion-title">Инструкция: Особо охраняемые природные территории России (ООПТ)</h3>
                                <svg class="accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </div>
                            <div class="accordion-content">
                                <div class="accordion-body">
                                    <h3>Инструкция по загрузке границ особо охраняемых территорий (ООПТ)</h3>
                                    <div>
                                        <p>Для загрузки границ ООПТ используется ресурс
                                            <a href="https://оцзк.рф/"> "Онлайн-центр заповедных компетенций".</a></p>
                                        <p>Для загрузки территории необходимо:</p>

                                        <ol>
                                            <li>Открыть <a href="https://карта.оцзк.рф/">Карта ООПТ</a>.
                                            </li>
                                            <li>Найти объект с помощью фильтра.</li>
                                            <li>Кликнуть объект вызвав его меню.</li>
                                            <li>Скачать Shapefile.</li>
                                            <li>Нажать кнопку "Особо охранные природные территории".</li>
                                            <li>Выбрать скачанный Shapefile на диске.</li>
                                        </ol>
                                    </div>
                                    <div
                                            style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; margin-top: 20px;">
                                        <iframe
                                                style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
                                                src="https://www.youtube.com/embed/j8jSFBA1eao"
                                                title="YouTube video player" frameborder="0"
                                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                                allowfullscreen>
                                        </iframe>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </section>

        {% if error %}
            <div class="alert alert-error">
                {{ error }}
            </div>
        {% endif %}

        {% if processed or skipped %}
            <section class="results-section">
                <div class="tabs results-tabs">
                    <button class="tab-btn {% if processed %}active{% endif %}" data-tab="processed"
                            data-group="results-tabs">Загружено
                    </button>
                    <button class="tab-btn {% if not processed and skipped %}active{% endif %}" data-tab="skipped"
                            data-group="results-tabs">Пропущено
                    </button>
                </div>

                <div class="tab-content {% if processed %}active{% endif %}" id="processed-tab"
                     data-group="results-tabs">
                    {% if processed %}
                        <div class="table-wrapper">
                            <table class="results-table">
                                <thead>
                                <tr>
                                    <th>Файл</th>
                                    <th>Описание</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for item in processed %}
                                    <tr>
                                        <td>{{ item.name }}</td>
                                        <td>{{ item.desc }}</td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <p class="empty-message">Нет загруженных файлов</p>
                    {% endif %}
                </div>

                <div class="tab-content {% if not processed and skipped %}active{% endif %}" id="skipped-tab"
                     data-group="results-tabs">
                    {% if skipped %}
                        <div class="table-wrapper">
                            <table class="results-table error-table">
                                <thead>
                                <tr>
                                    <th>Файл</th>
                                    <th>Причина</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for item in skipped %}
                                    <tr>
                                        <td>{{ item.name }}</td>
                                        <td>{{ item.reason }}</td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <p class="empty-message">Нет пропущенных файлов</p>
                    {% endif %}
                </div>
            </section>
        {% endif %}

        {% if logs %}
            <section class="terminal-section">
                <div class="terminal">
                    {% for log in logs %}
                        <div class="terminal-line terminal-{{ log.level }}">
                            <span class="terminal-prompt">$</span>
                            <span class="terminal-time">[{{ log.time }}]</span>
                            <span class="terminal-text">{{ log.message }}</span>
                        </div>
                    {% endfor %}
                </div>
            </section>
        {% endif %}
    </main>
</div>

<script>
    // Функция для работы аккордеона
    function toggleAccordion(header) {
        const content = header.nextElementSibling;
        const icon = header.querySelector('.accordion-icon');

        // Закрываем все остальные аккордеоны в той же группе
        const accordion = header.closest('.accordion');
        const allItems = accordion.querySelectorAll('.accordion-content');
        const allIcons = accordion.querySelectorAll('.accordion-icon');

        allItems.forEach((item, index) => {
            if (item !== content) {
                item.classList.remove('active');
                allIcons[index].classList.remove('active');
            }
        });

        // Переключаем текущий аккордеон
        content.classList.toggle('active');
        icon.classList.toggle('active');
    }

    const fileInputs = {
        shp: document.getElementById('files_shp'),
        geojson: document.getElementById('files_geojson'),
        gpx: document.getElementById('files_gpx'),
        kml: document.getElementById('files_kml'),
        topojson: document.getElementById('files_topojson'),
        wkt: document.getElementById('files_wkt')
    };

    const uploadButtons = {
        shp: document.getElementById('uploadBtn'),
        geojson: document.getElementById('uploadBtnGeojson'),
        gpx: document.getElementById('uploadBtnGpx'),
        kml: document.getElementById('uploadBtnKml'),
        topojson: document.getElementById('uploadBtnTopojson'),
        wkt: document.getElementById('uploadBtnWkt'),
        nspdLocality: document.getElementById('uploadBtnNspdlocality'),
        nspdBorder: document.getElementById('uploadBtnNspdBorder'),
        ootp: document.getElementById('uploadBtnOotp')
    };

    const nspdInput = document.getElementById('nspd_registry_number');
    const nspdBorderInput = document.getElementById('nspd_border_registry_number');

    function createTerminal() {
        const terminalSection = document.createElement('section');
        terminalSection.className = 'terminal-section';
        terminalSection.innerHTML = '<div class="terminal" id="realtime-terminal"></div>';

        const existing = document.querySelector('.terminal-section');
        if (existing) existing.remove();

        document.querySelector('main').appendChild(terminalSection);
        return document.getElementById('realtime-terminal');
    }

    function addLogLine(terminal, logEntry) {
        const logLine = document.createElement('div');
        logLine.className = `terminal-line terminal-${logEntry.level}`;
        logLine.innerHTML = `
            <span class="terminal-prompt">$</span>
            <span class="terminal-time">[${logEntry.time}]</span>
            <span class="terminal-text">${logEntry.message}</span>
        `;
        terminal.appendChild(logLine);
        terminal.scrollTop = terminal.scrollHeight;
    }

    function addCompletionMessage(terminal) {
        const completeLine = document.createElement('div');
        completeLine.className = 'terminal-line terminal-info';
        completeLine.innerHTML = `
            <span class="terminal-prompt">$</span>
            <span class="terminal-time">[${new Date().toTimeString().slice(0, 8)}]</span>
            <span class="terminal-text">Процесс завершен...</span>
        `;
        terminal.appendChild(completeLine);
    }

    function addErrorMessage(terminal, error) {
        const errorLine = document.createElement('div');
        errorLine.className = 'terminal-line terminal-error';
        errorLine.innerHTML = `
            <span class="terminal-prompt">$</span>
            <span class="terminal-time">[${new Date().toTimeString().slice(0, 8)}]</span>
            <span class="terminal-text">Error: ${error.message}</span>
        `;
        terminal.appendChild(errorLine);
    }

    function handleAsyncUpload(endpoint, formData) {
        const terminal = createTerminal();

        fetch(endpoint, {
            method: 'POST',
            body: formData
        })
            .then(response => response.json())
            .then(data => {
                const eventSource = new EventSource(`/stream-logs/${data.session_id}`);

                eventSource.onmessage = (event) => {
                    addLogLine(terminal, JSON.parse(event.data));
                };

                eventSource.onerror = () => {
                    eventSource.close();
                    addCompletionMessage(terminal);
                };
            })
            .catch(error => {
                console.error('Upload error:', error);
                addErrorMessage(terminal, error);
            });
    }

    uploadButtons.nspdLocality.addEventListener('click', () => {
        const val = nspdInput.value.trim();
        if (!val) {
            alert("Введите реестровый номер населенного пункта");
            return;
        }
        const formData = new FormData();
        formData.append('registry_number', val);
        handleAsyncUpload('/upload-nspd-async', formData);
    });

    uploadButtons.nspdBorder.addEventListener('click', () => {
        const val = nspdBorderInput.value.trim();
        if (!val) {
            alert("Введите реестровый номер муниципального образования");
            return;
        }
        const formData = new FormData();
        formData.append('registry_number', val);
        handleAsyncUpload('/upload-nspd-border-async', formData);
    });

    if (uploadButtons.ootp) {
        uploadButtons.ootp.addEventListener('click', () => fileInputs.shp.click());
    }

    Object.entries(fileInputs).forEach(([format, input]) => {
        const button = uploadButtons[format];
        if (button) {
            button.addEventListener('click', () => input.click());
        }

        input.addEventListener('change', (e) => {
            if (e.target.files.length === 0) return;

            const formData = new FormData();
            for (let file of e.target.files) {
                formData.append('files', file);
            }
            handleAsyncUpload('/upload-async', formData);
        });
    });

    const allTabBtns = document.querySelectorAll('.tab-btn');
    allTabBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            const group = btn.getAttribute('data-group');
            const tabId = btn.getAttribute('data-tab');
            const groupBtns = document.querySelectorAll(`.tab-btn[data-group="${group}"]`);
            const groupContents = document.querySelectorAll(`.tab-content[data-group="${group}"]`);

            groupBtns.forEach(b => b.classList.remove('active'));
            groupContents.forEach(c => c.classList.remove('active'));

            btn.classList.add('active');
            const content = document.getElementById(tabId + '-tab');
            if (content) {
                content.classList.add('active');
            }
        });
    });
</script>
</body>

</html>